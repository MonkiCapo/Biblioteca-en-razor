@page
@model Biblioteca.Pages.Catalogo.IndexModel

<h2>Catálogo de libros</h2>

@if (User.IsInRole("Admin"))
{
    <a asp-page="Crear" class="btn btn-primary mb-3">
        Agregar libro al catálogo
    </a>
}

<table class="table">

    <tr>
        <th>Imagen</th>   <!-- ✅ NUEVO -->
        <th>Título</th>
        <th>Autor</th>
        <th>Año</th>
        <th>Acciones</th>
    </tr>

@foreach (var libro in Model.Catalogo)
{
    <tr>
        <td>
            @if (!string.IsNullOrEmpty(libro.ImagenUrl))
            {
                <img src="@libro.ImagenUrl" width="80" />
            }
            else
            {
                <span>Sin imagen</span>
            }
        </td>

        <td>@libro.Titulo</td>
        <td>@libro.Autor</td>
        <td>@libro.Anio</td>

        <td>
            <div style="display:flex; gap:8px; flex-wrap:wrap;">

                @if (libro.YaEnMiBiblioteca)
                {
                    <button disabled class="btn btn-secondary">
                        Ya en tu biblioteca
                    </button>
                }
                else
                {
                    <form method="post">
                        <input type="hidden" name="id" value="@libro.Id" />
                        <button type="submit" class="btn btn-success">
                            Agregar a mi biblioteca
                        </button>
                    </form>
                }

                @if (User.IsInRole("Admin"))
                {
                    <a asp-page="Editar"
                       asp-route-id="@libro.Id"
                       class="btn btn-warning">
                        Editar
                    </a>

                    <a asp-page="Eliminar"
                       asp-route-id="@libro.Id"
                       class="btn btn-danger">
                        Eliminar
                    </a>
                }

            </div>
        </td>
    </tr>
}
</table>
